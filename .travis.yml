language: node_js
node_js:
- 9.10.1
services:
- neo4j
- redis-server
notifications:
  email:
    on_failure: change
    on_success: change
addons:
  ssh_known_hosts:
  - 167.99.98.101
branches:
  only:
  - master
  - Development
  - Testing
env:
  global:
  - REMOTE_APP_DIR=/var/www/cooper.mx/
  - REMOTE_USER=deploy
  - REMOTE_HOST=167.99.98.101
  - NODE_ENV=testing
  - PORT=80
  - NEO4J_VERSION="3.3.2"
  - secure: gORcpA32ydnRLFWA8LgFKrAaLpgEme3WCUmNi1CcZsP3A0ASQCa8fOsORD4v5n+gSGF5RSul6LIOyNcvODdyQi0TwuxvRvxkCQYCuh/JUIWjzZu/MuT3LjOsibpEpezddjsyegfw7riOri31C4/7a621QTeIiEOi+GfZHHM7l70E96mWiiVpqJFYhuyiWJxPme+STGoxB+hQjkuasLQmEHesZBNJTw8ippUcwnQGsD5W5hSlD79qam511njTq/gzSKTEjlzSmB6J42NmyKFR7etTMXEhO9DBp2Yw+xMwhLmNdj/MmKA1fpDgpyhyleKNhaagRaaQZDnXrVsmeHMUsNYHfQIc0CnlcQVF3UV3mfgPOzjFlHUq/GvH4nGKb+hVtmeg797oBX8qQ9QthdZPWEnQDrapGPfmf8DY1nmSxd8buBRkqpOf3BWe7Ek+ikP6hp2EllaJmhQ/JcpIbE+NyG6yWdpTXEgyEf4Kb0jNazWnW3K43/+cm4cuEfQrf7f902MiuQajA0tRmV8wP55CJr6230SPcT8h0npIM2pWexDLf75nvWCsUktJPinNR0kZL+hjNu23Dp4lKHsvEE0QJWnA6T/QJu1mpLEZ5YbZaH7pcDyrQYwSRer8Fl5hMsv61NXLWDkHcJ6CuuzE4bw8JtuzSl458/AZbyZBIF/kpao=
  - secure: s3FJjHWIlIHTxmrKcdfpQ40Hyuk46wxjFiVOY8+IDQJd7KaL+gHB6Kaow8I8RxVw+5uvVlNOm/9zewMAa6ONt929CLE9Jbhjq9fDrS2kjZodyK7Vvu9qQA1CLXjVZ5K35UDULUsdLBaHM+0DHnGtrOD2NTgwavsurnigqRqkBU1PzbAbXAjTTicE7d10DK3VkcIqn4RiRYpwECvw8x6l1nelmFs7htFmFmnpqrYXXS8a2isDwzuG2KXNbCpiNlT7L1MXx2sMKFUv63DLEfrQkX5gDFFeIHpvi236/N6QxocnoXdtlzpiNtuNiTOcbxZDtJVnbWLwa6C/xmqGP4nMSg1IoYwQ+BiLXAsnNdtj/UAZJpXdQVwTfCqE5/WTpNL++MNgmxN46/a/hodHjkDOBkQDcPUlx1PDPHxwJpuvcXB/YdBqsWjUgYOp5xjWLFmTbKisL0xP2sN4W4/TjrxcAdhNM6AX4PHm8eLRIGe3mlD+kCJtzQjhMscV122itIycbFA1V1nRQynDIxTkDHn+6w9lHAK0NWgLFKMMOcDOZnLnjTnyCd14mwP3xbB1ZJA+2nZFtYX8DZ4n7q4CVZNO9pRUFgJ8hM4SfrEbkrmhAeBYu8pCmKsDx3SxDwjbNesn2qZTkhE787Kk5yvfeLWCokgZ6tOBt3Fm4Pjt+sI//dA=
  - secure: wYhhzUQ/HRGjbfYeRZcMm2674+Ka3F7rqReJNTlBgk8uptJkVCQc4zme9qqnoAw9EUCllP/Xq/isxwhvjE++aIO64s2b8pMFYsvKKoqQMUMsXt1x5a2P1lbpwfNJ//Q7u+hUJlea/kcEeRDv0TnHY5XdBrKfoE4wnz9Lk0EUliRvQHi5U9sKwzSkWhdIw68qnIBloalelC1/fRdhHUR4k/5DbjJdIZmXBHlbfHpmYFIaQ7TQ+RZBjr+rCsWb2pNWn4aOStw4g/S0LhjZgsdBoq5/CsADSE+Np2Yx7UYRuVI604oHsbaNv4SSG4LXjH20+4bypCjG8k7YxARJb+0Zsj1hLhO5xjOXSBw37BVG4KCryoQwdyCF55+TQlUMM0z3zmsePIYPtMjTdsNK64Dx/XitdUiIBBapKligf4qb4tlasH4HdgG6+oPwrjvMOC2QdW8UG1RNlK+vGsaSubzwY+eghxjyhBHZJuVyDbJX7G1yTAabTe34cEkzcMX9qQeY8qEBaY9cOWyuFlTWZU9vPwEpT+aAnNVU5gxR3UTO5jxBERL1kFUA7fGZi9qa/9NRlpLu6v+0jykf+uvCmZmcFlXfXhQwdO8NWV3dsjRkMldGt6HaWW34kUayzs3vmT3gtWm970pp5b4r51dloxtW0Ods+15m7sLy+yGiKnaZZ+Q=
  - secure: dzUZRPe4cUwblTNsePxJjxHfWPjj62cUR+NPjUD/o1A2oNqhmSqzfJbjOdC8l0J40bgxuCEGzuwvew23cMs/E98Raa+7ZXT+I1QrP5maQzRJ1/TjtNvmU6xzRICiIbudfH+sfgmYwH0tV+SgwoCnFugMwggz8xm05HQM/WVbEz5Il6aW/KCzRS49U7YIoSR83SbXRxU7vu9nuyaS0BPD8rM5HSjbJMJ2BfQlduk6PkDnhCQSOXWfROHETsj4yzsjtQjXAnqAZ6VglPUIP/R/jKqUga7FLkaGeo8wxm2cFt8r8/wtxeGzMkSPeYElG69miXLr/tS5gN3vXfBKs1VTC46j9sZ2gFn413/37zNh4GrpZb9CCHA4KJqN70YQ2zJ/zx7hcUeK49Su01yRaQY0GcVoYZJwrFxMnRHMihRio1HyoVt1uJWjEVPbErK8l1bIff0ZkEjvylrmEEb/27UC5lQrSpZsvvhY0sCibY7UAY8nM3aZLL9Krp4dYCtkInDj0e6lH9FFUXwHrT6h/3TV+IywoBT95oMnhmvrJXi+SxiyjfungunilIFik12lDRldfm6eLgUIcuoZYfVjrtlN2UNtDb+uh44g3YSENX12MONvEL/E18r0WQ+5I/gKhcn4cpiJvHOcM21kyWIuqRydjSqnlrDgTsFeQ0u5L8n7v5g=
  - secure: AwDRz8Wuf96AyXcD9g6xAm/5lYSgsdx6hc4qkPQkT88OnDn1LNZDUf+ruPIUWaNf+yaSwtxkhNE3zsNvT3zitYMC1moVmF+4N5kJcDKCsxvGEEYz1N+mZ65bIbXIScPT2vVZLnCKj++3Fy9VAu1PNF5tRt5NXwB3zdIXsxuluwMu690wizZntNFIGz/w/XIgT+2+YV+S5lnSYvXF6IQGhtYj3PIdwLTHxvpA9dvCiKXkOia2SuNEbef7WzdwRiTmMWIDR1frjOVng0oF2AxehvmfKw9Kk5kz0J8rQNTL17T3s/Jqz2EMdWfT9GCAq5ezEfoJe3srtz9EKWr8r4TeAtR2BBp6vvRiGi+aCoX0WIJxPn41US85ZE3DZE5UedfXPmFftOz28o51ORDaX3BKGdvMlYHBT3QRoHHMc+eRXDwlNakGCw761gcgDMZgwhlGvL98uyIKou6LKOq5U1ODwCIn5Q59d7CSbm4zDTHGgMlD4viDnWJyQcgMT3HSE7NuvovuDa8qLnANrAuVCO55TmyWmBA1uG6YDHdI8Zc3+lt0uGn/p7hNEc/6Ae5pj7OtDjlibkkngy7z9UJkQIElcOZSESoionQnJcbv1rghhb7iGIVBN4lzxmu1FSYhKbA/USGMBjeqM6wiXoAOG57rhQflCGLEbbAWTVXr2Lonqfo=
  - secure: xNjEhkRlJRd8taViUsusGgAtAujCN4QSdY28qtQ5Zwt/h4hg0z2R/ipSZhNH8erphHosNawCwDsbiIXRhu4jlX4cIyGhheIzY75RQh9BxVVWhICFzouJOmUN9GylXd+lIm6025kJbv5Vipl4ykL1IAew9FFQOZUtgzpx1Nwm1s7JOw6Su+u9tJdasEpmh4YSyDafMZ9WrB50OVhocyIhctQfupq75a0i1IBPs8D0+MzluMzzdvr4Nk8inMBb1Rk1eznYn49EfKMM0mC6Lvsqr+bzUrHk+A8ghKXgjF22poZD+b1w8MM6uuYF7w7Ya0HEWkURo8coERq51i/e0GJ4tsa4TPfjkETHUapn2dghZnaAEAaUWPlnGQyIrXlHZuhdHG5SQBwqvwRvo9EFg9aF8tDnCfmK2HxkcapDPCJUokoxx9jSEnk81a7AlwtJKEXA7ZpFzzQRX4fTHNsoEHgvdRWyCoNbssbuAo21bIvkBA0OKFocYvWRyFV+Gfz2fgm16+Lnf9R3aXDfvj2YkKvYI98cXuSBlouX/ux+7e5BemMWsTh5laPNoXgcfsxChpAWE2fbEq8VbeAY1NqNKa64exLE4y4gB/fShhX0nKrJIjsr7SjJaof9m/XEdItlfCaCNfdlwrl0bJZIPRGZ4PyYI/2c0YtVJBsZPyDNfT0JSJA=
  - secure: 1xOZAHIX7aqT56nm7B+tCvl8a9aUU+Hcz1V1o4kf3zbgGDRyYEuZuov80EAWHUaguAZOndz6OyGIbsYEfbyY+IHsYTtVgoJJaf+qnbY4DJ7/PRvv587f5LaUwB8dH2adtC5rXYxfz+69d/e0k9vVb+6B8CflIl2QhGYTTxOYIHp9AKYkqjqRGx1FZF0kPiuYlYZ5xfrYQzNx3dd1nEuUPC8gDG6TSBEa5lcGtAyMVpry963xSfigY3Cg4Tdm1V3QWatitl0qzNIjPP0tjDmWCdd5tJLz4To4aj74f+EKItA8p9mCAoUXM0u/R47opM2w/yQ/wLaWPoxxCb6MQmIjRa9ygSUP9KEohr9SCPEO5F0kCPVDmTSLpFpb1bmdiVkbqJFJTtSq6MkLBcGq2Wg4wJJcHlbcecX5klKL9tA0A3eWTPzXiEMeymX2q0LjZf6T7oFHVR+L38flHsldN14vz4ofFLB98j1Fhg7Rfflx0DMbk/DppgbGnEogenMRHs4yU3dyga0agaWsHQe2J9qdUZxDGbjANCZl54Xef6thGt1qIyFfDLGwkqfPC8xOXrrYX6ompAIGRxBphZCIKcmBp9djWplsiq0ypbghqs8TFOY2DfA41GdMXQqDvSOCfRNZp1UA/K3GVuOWJWvYow3OU8ETqkxjSobjvsUuxysH0Wo=
  - secure: S6URqwzzUXu9+U7iE9RuGySPIUvuEFmZb+9fAbEMfoJKc7coNoq9Ltxg9O4zx79nMYusQvAJ1bivV3Z/B7qUeu00Xa7SD2zPfdf558H3kqlplyeaAevC5X8zIOyljWzl8ZTU5pfYp8kFL43gBwlhotpfEMN+zjCD/m8g6dFMPxS2zw9/7xRSwww59SH817PGttzg0SzU+TyIHABvoGc/V0+GbRkyl7Siog7CMUqJ7JpJQMuUDdqHvIavTIpmjcI7OgmnJiy4s1JR2Z4CPDXiJNLNcFHB1y9g7xmFXyeFU4JHk1R5TTL5ZbeNglcnTmAo8e4THr2pVL0i4JQrMMw8n/6HV2OYcRHOLCB4hTHTsmSjK0hS86HSXEHCuRnXrz+LHpFWuTS3ZJeYWu1yB9IfZ3pGGc6RVpSPEKeLb2OCvr/T6OuJn4GMsQVNJLPW0wrZvThWKGKX3tBetIJK+bAq5bwz5WOwLbo8SnldFAeqAV20pWScl2JFyKd/PkALWYqPi4AWUG8L5DJnluxKUMtADoBq9Th7hXfvfazj0hcW6ixqvgHKxrhFQKfaphvR3dLISJbtQA9nIJHevFdQHkzqoA10lt2xTClkMiKYxaNN0DfX3VY7/iwVvM6pgPehovocPn5TS1aMSO4Q1bbHYW2xOzxM9J9TAxwKfkosxm5/E70=
cache:
  directories:
  - node_modules
before_install:
- openssl aes-256-cbc -K $encrypted_7c1afc1ba21b_key -iv $encrypted_7c1afc1ba21b_iv
  -in deploy.enc -out deploy -d
install:
- npm install
before_script:
- chmod 600 deploy && mv deploy ~/.ssh/id_rsa
script:
- npm run build
deploy:
  skip_cleanup: true
  provider: script
  script: bash scripts/deploy.sh
  on:
    branch: master
